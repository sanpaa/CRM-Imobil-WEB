<div class="property-detail-container">

  <!-- Loading -->
  <div *ngIf="loading" class="state state-loading">
    <i class="fas fa-spinner fa-spin"></i>
    <p>Carregando imóvel...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error && !loading" class="state state-error">
    <i class="fas fa-exclamation-triangle"></i>
    <h2>Imóvel não encontrado</h2>
    <a routerLink="/" class="btn-primary">Voltar para Home</a>
  </div>

  <!-- Content -->
  <div *ngIf="property && !loading">

    <a routerLink="/" class="back-button">
      <i class="fas fa-arrow-left"></i> Voltar
    </a>

    <!-- Header -->
    <header class="property-header">
      <h1>{{ property.title }}</h1>

      <div class="price">R$ {{ formatPrice(property.price) }}</div>

      <div class="location">
        <i class="fas fa-map-marker-alt"></i> {{ getLocation() }}
      </div>

      <div class="badges">
        <span *ngIf="property.featured" class="badge featured">Destaque</span>
        <span *ngIf="property.sold" class="badge sold">Vendido</span>
        <span *ngIf="!property.sold" class="badge available">Disponível</span>
      </div>
    </header>

    <!-- Gallery -->
    <section *ngIf="images.length" class="gallery">
      <div class="gallery-main">
        <img [src]="currentImage" [alt]="property.title">

        <button *ngIf="images.length > 1" class="nav prev" (click)="prevImage()">
          <i class="fas fa-chevron-left"></i>
        </button>
        <button *ngIf="images.length > 1" class="nav next" (click)="nextImage()">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>

      <div *ngIf="images.length > 1" class="thumbs">
        <img
          *ngFor="let img of images; let i = index"
          [src]="img"
          [class.active]="i === currentImageIndex"
          (click)="selectImage(i)"
        />
      </div>
    </section>

    <!-- Grid -->
    <div class="content-grid">

      <!-- Main -->
      <main class="main-info">
        <h2>Descrição</h2>
        <p>{{ property.description || 'Sem descrição disponível.' }}</p>

        <h2>Características</h2>
        <div class="features">
          <div *ngIf="property.type"><strong>Tipo</strong><span>{{ property.type }}</span></div>
          <div *ngIf="property.bedrooms"><strong>Quartos</strong><span>{{ property.bedrooms }}</span></div>
          <div *ngIf="property.bathrooms"><strong>Banheiros</strong><span>{{ property.bathrooms }}</span></div>
          <div *ngIf="property.area"><strong>Área</strong><span>{{ property.area }} m²</span></div>
          <div *ngIf="property.parking"><strong>Vagas</strong><span>{{ property.parking }}</span></div>
        </div>

        <div *ngIf="property.latitude && property.longitude" class="map-section">
          <h2>Localização</h2>
          <div id="property-map" class="map"></div>
          <a [href]="getMapsLink()" target="_blank" class="btn-secondary">
            Abrir no Google Maps
          </a>
        </div>
      </main>

      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="contact-box">
          <h3>Fale com a Imobiliária</h3>
          <a [href]="getWhatsAppLink()" target="_blank" class="btn-whatsapp">
            <i class="fab fa-whatsapp"></i> WhatsApp
          </a>
          <small>Atendimento rápido e seguro</small>
        </div>
      </aside>

    </div>
  </div>
</div>
